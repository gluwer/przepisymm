/* Copyright (c) 2009-2010 Rafal Jonca; Includes also several jQuery plugins. */

jQuery.fn.extend({getUrlParam:function(strParamName){strParamName=escape(unescape(strParamName));var returnVal=new Array();var qString=null;if($(this).attr("nodeName")=="#document"){if(window.location.search.search(strParamName)>-1){qString=window.location.search.substr(1,window.location.search.length).split("&");}}else if($(this).attr("src")!="undefined"){var strHref=$(this).attr("src")
if(strHref.indexOf("?")>-1){var strQueryString=strHref.substr(strHref.indexOf("?")+1);qString=strQueryString.split("&");}}else if($(this).attr("href")!="undefined"){var strHref=$(this).attr("href")
if(strHref.indexOf("?")>-1){var strQueryString=strHref.substr(strHref.indexOf("?")+1);qString=strQueryString.split("&");}}else{return null;}
if(qString==null)return null;for(var i=0;i<qString.length;i++){if(escape(unescape(qString[i].split("=")[0]))==strParamName){returnVal.push(qString[i].split("=")[1]);}}
if(returnVal.length==0)return null;else if(returnVal.length==1)return returnVal[0];else return returnVal;}});(function($){$.fn.alphanumeric=function(p){p=$.extend({ichars:"!@#$%^&*()+=[]\\\';,/{}|\":<>?~`.- ",nchars:"",allow:""},p);return this.each
(function()
{if(p.nocaps)p.nchars+="ABCDEFGHIJKLMNOPQRSTUVWXYZ";if(p.allcaps)p.nchars+="abcdefghijklmnopqrstuvwxyz";s=p.allow.split('');for(i=0;i<s.length;i++)if(p.ichars.indexOf(s[i])!=-1)s[i]="\\"+s[i];p.allow=s.join('|');var reg=new RegExp(p.allow,'gi');var ch=p.ichars+p.nchars;ch=ch.replace(reg,'');$(this).keypress
(function(e)
{if(!e.charCode)k=String.fromCharCode(e.which);else k=String.fromCharCode(e.charCode);if(ch.indexOf(k)!=-1)e.preventDefault();if(e.ctrlKey&&k=='v')e.preventDefault();});$(this).bind('contextmenu',function(){return false});});};$.fn.numeric=function(p){var az="abcdefghijklmnopqrstuvwxyz";az+=az.toUpperCase();p=$.extend({nchars:az},p);return this.each(function()
{$(this).alphanumeric(p);});};$.fn.alpha=function(p){var nm="1234567890";p=$.extend({nchars:nm},p);return this.each(function()
{$(this).alphanumeric(p);});};})(jQuery);;(function($){$.fn.extend({autocomplete:function(urlOrData,options){var isUrl=typeof urlOrData=="string";options=$.extend({},$.Autocompleter.defaults,{url:isUrl?urlOrData:null,data:isUrl?null:urlOrData,delay:isUrl?$.Autocompleter.defaults.delay:10,max:options&&!options.scroll?10:150},options);options.highlight=options.highlight||function(value){return value;};options.formatMatch=options.formatMatch||options.formatItem;return this.each(function(){new $.Autocompleter(this,options);});},result:function(handler){return this.bind("result",handler);},search:function(handler){return this.trigger("search",[handler]);},flushCache:function(){return this.trigger("flushCache");},setOptions:function(options){return this.trigger("setOptions",[options]);},unautocomplete:function(){return this.trigger("unautocomplete");}});$.Autocompleter=function(input,options){var KEY={UP:38,DOWN:40,DEL:46,TAB:9,RETURN:13,ESC:27,COMMA:188,PAGEUP:33,PAGEDOWN:34,BACKSPACE:8};var $input=$(input).attr("autocomplete","off").addClass(options.inputClass);var timeout;var previousValue="";var cache=$.Autocompleter.Cache(options);var hasFocus=0;var lastKeyPressCode;var config={mouseDownOnSelect:false};var select=$.Autocompleter.Select(options,input,selectCurrent,config);var blockSubmit;$.browser.opera&&$(input.form).bind("submit.autocomplete",function(){if(blockSubmit){blockSubmit=false;return false;}});$input.bind(($.browser.opera?"keypress":"keydown")+".autocomplete",function(event){hasFocus=1;lastKeyPressCode=event.keyCode;switch(event.keyCode){case KEY.UP:event.preventDefault();if(select.visible()){select.prev();}else{onChange(0,true);}
break;case KEY.DOWN:event.preventDefault();if(select.visible()){select.next();}else{onChange(0,true);}
break;case KEY.PAGEUP:event.preventDefault();if(select.visible()){select.pageUp();}else{onChange(0,true);}
break;case KEY.PAGEDOWN:event.preventDefault();if(select.visible()){select.pageDown();}else{onChange(0,true);}
break;case options.multiple&&$.trim(options.multipleSeparator)==","&&KEY.COMMA:case KEY.TAB:case KEY.RETURN:if(selectCurrent()){event.preventDefault();blockSubmit=true;return false;}
break;case KEY.ESC:select.hide();break;default:clearTimeout(timeout);timeout=setTimeout(onChange,options.delay);break;}}).focus(function(){hasFocus++;}).blur(function(){hasFocus=0;if(!config.mouseDownOnSelect){hideResults();}}).click(function(){if(hasFocus++>1&&!select.visible()){onChange(0,true);}}).bind("search",function(){var fn=(arguments.length>1)?arguments[1]:null;function findValueCallback(q,data){var result;if(data&&data.length){for(var i=0;i<data.length;i++){if(data[i].result.toLowerCase()==q.toLowerCase()){result=data[i];break;}}}
if(typeof fn=="function")fn(result);else $input.trigger("result",result&&[result.data,result.value]);}
$.each(trimWords($input.val()),function(i,value){request(value,findValueCallback,findValueCallback);});}).bind("flushCache",function(){cache.flush();}).bind("setOptions",function(){$.extend(options,arguments[1]);if("data"in arguments[1])
cache.populate();}).bind("unautocomplete",function(){select.unbind();$input.unbind();$(input.form).unbind(".autocomplete");});function selectCurrent(){var selected=select.selected();if(!selected)
return false;var v=selected.result;previousValue=v;if(options.multiple){var words=trimWords($input.val());if(words.length>1){var seperator=options.multipleSeparator.length;var cursorAt=$(input).selection().start;var wordAt,progress=0;$.each(words,function(i,word){progress+=word.length;if(cursorAt<=progress){wordAt=i;return false;}
progress+=seperator;});words[wordAt]=v;v=words.join(options.multipleSeparator);}
v+=options.multipleSeparator;}
$input.val(v);hideResultsNow();$input.trigger("result",[selected.data,selected.value]);return true;}
function onChange(crap,skipPrevCheck){if(lastKeyPressCode==KEY.DEL){select.hide();return;}
var currentValue=$input.val();if(!skipPrevCheck&&currentValue==previousValue)
return;previousValue=currentValue;currentValue=lastWord(currentValue);if(currentValue.length>=options.minChars){$input.addClass(options.loadingClass);if(!options.matchCase)
currentValue=currentValue.toLowerCase();request(currentValue,receiveData,hideResultsNow);}else{stopLoading();select.hide();}};function trimWords(value){if(!value)
return[""];if(!options.multiple)
return[$.trim(value)];return $.map(value.split(options.multipleSeparator),function(word){return $.trim(value).length?$.trim(word):null;});}
function lastWord(value){if(!options.multiple)
return value;var words=trimWords(value);if(words.length==1)
return words[0];var cursorAt=$(input).selection().start;if(cursorAt==value.length){words=trimWords(value)}else{words=trimWords(value.replace(value.substring(cursorAt),""));}
return words[words.length-1];}
function autoFill(q,sValue){if(options.autoFill&&(lastWord($input.val()).toLowerCase()==q.toLowerCase())&&lastKeyPressCode!=KEY.BACKSPACE){$input.val($input.val()+sValue.substring(lastWord(previousValue).length));$(input).selection(previousValue.length,previousValue.length+sValue.length);}};function hideResults(){clearTimeout(timeout);timeout=setTimeout(hideResultsNow,200);};function hideResultsNow(){var wasVisible=select.visible();select.hide();clearTimeout(timeout);stopLoading();if(options.mustMatch){$input.search(function(result){if(!result){if(options.multiple){var words=trimWords($input.val()).slice(0,-1);$input.val(words.join(options.multipleSeparator)+(words.length?options.multipleSeparator:""));}
else{$input.val("");$input.trigger("result",null);}}});}};function receiveData(q,data){if(data&&data.length&&hasFocus){stopLoading();select.display(data,q);autoFill(q,data[0].value);select.show();}else{hideResultsNow();}};function request(term,success,failure){if(!options.matchCase)
term=term.toLowerCase();var data=cache.load(term);if(data&&data.length){success(term,data);}else if((typeof options.url=="string")&&(options.url.length>0)){var extraParams={timestamp:+new Date()};$.each(options.extraParams,function(key,param){extraParams[key]=typeof param=="function"?param():param;});$.ajax({mode:"abort",port:"autocomplete"+input.name,dataType:options.dataType,url:options.url,data:$.extend({q:lastWord(term),limit:options.max},extraParams),success:function(data){var parsed=options.parse&&options.parse(data)||parse(data);cache.add(term,parsed);success(term,parsed);}});}else{select.emptyList();failure(term);}};function parse(data){var parsed=[];var rows=data.split("\n");for(var i=0;i<rows.length;i++){var row=$.trim(rows[i]);if(row){row=row.split("|");parsed[parsed.length]={data:row,value:row[0],result:options.formatResult&&options.formatResult(row,row[0])||row[0]};}}
return parsed;};function stopLoading(){$input.removeClass(options.loadingClass);};};$.Autocompleter.defaults={inputClass:"ac_input",resultsClass:"ac_results",loadingClass:"ac_loading",minChars:1,delay:400,matchCase:false,matchSubset:true,matchContains:false,cacheLength:10,max:100,mustMatch:false,extraParams:{},selectFirst:true,formatItem:function(row){return row[0];},formatMatch:null,autoFill:false,width:0,multiple:false,multipleSeparator:", ",highlight:function(value,term){return value.replace(new RegExp("(?![^&;]+;)(?!<[^<>]*)("+term.replace(/([\^\$\(\)\[\]\{\}\*\.\+\?\|\\])/gi,"\\$1")+")(?![^<>]*>)(?![^&;]+;)","gi"),"<strong>$1</strong>");},scroll:true,scrollHeight:180};$.Autocompleter.Cache=function(options){var data={};var length=0;function matchSubset(s,sub){if(!options.matchCase)
s=s.toLowerCase();var i=s.indexOf(sub);if(options.matchContains=="word"){i=s.toLowerCase().search("\\b"+sub.toLowerCase());}
if(i==-1)return false;return i==0||options.matchContains;};function add(q,value){if(length>options.cacheLength){flush();}
if(!data[q]){length++;}
data[q]=value;}
function populate(){if(!options.data)return false;var stMatchSets={},nullData=0;if(!options.url)options.cacheLength=1;stMatchSets[""]=[];for(var i=0,ol=options.data.length;i<ol;i++){var rawValue=options.data[i];rawValue=(typeof rawValue=="string")?[rawValue]:rawValue;var value=options.formatMatch(rawValue,i+1,options.data.length);if(value===false)
continue;var firstChar=value.charAt(0).toLowerCase();if(!stMatchSets[firstChar])
stMatchSets[firstChar]=[];var row={value:value,data:rawValue,result:options.formatResult&&options.formatResult(rawValue)||value};stMatchSets[firstChar].push(row);if(nullData++<options.max){stMatchSets[""].push(row);}};$.each(stMatchSets,function(i,value){options.cacheLength++;add(i,value);});}
setTimeout(populate,25);function flush(){data={};length=0;}
return{flush:flush,add:add,populate:populate,load:function(q){if(!options.cacheLength||!length)
return null;if(!options.url&&options.matchContains){var csub=[];for(var k in data){if(k.length>0){var c=data[k];$.each(c,function(i,x){if(matchSubset(x.value,q)){csub.push(x);}});}}
return csub;}else
if(data[q]){return data[q];}else
if(options.matchSubset){for(var i=q.length-1;i>=options.minChars;i--){var c=data[q.substr(0,i)];if(c){var csub=[];$.each(c,function(i,x){if(matchSubset(x.value,q)){csub[csub.length]=x;}});return csub;}}}
return null;}};};$.Autocompleter.Select=function(options,input,select,config){var CLASSES={ACTIVE:"ac_over"};var listItems,active=-1,data,term="",needsInit=true,element,list;function init(){if(!needsInit)
return;element=$("<div/>").hide().addClass(options.resultsClass).css("position","absolute").appendTo(document.body);list=$("<ul/>").appendTo(element).mouseover(function(event){if(target(event).nodeName&&target(event).nodeName.toUpperCase()=='LI'){active=$("li",list).removeClass(CLASSES.ACTIVE).index(target(event));$(target(event)).addClass(CLASSES.ACTIVE);}}).click(function(event){$(target(event)).addClass(CLASSES.ACTIVE);select();input.focus();return false;}).mousedown(function(){config.mouseDownOnSelect=true;}).mouseup(function(){config.mouseDownOnSelect=false;});if(options.width>0)
element.css("width",options.width);needsInit=false;}
function target(event){var element=event.target;while(element&&element.tagName!="LI")
element=element.parentNode;if(!element)
return[];return element;}
function moveSelect(step){listItems.slice(active,active+1).removeClass(CLASSES.ACTIVE);movePosition(step);var activeItem=listItems.slice(active,active+1).addClass(CLASSES.ACTIVE);if(options.scroll){var offset=0;listItems.slice(0,active).each(function(){offset+=this.offsetHeight;});if((offset+activeItem[0].offsetHeight-list.scrollTop())>list[0].clientHeight){list.scrollTop(offset+activeItem[0].offsetHeight-list.innerHeight());}else if(offset<list.scrollTop()){list.scrollTop(offset);}}};function movePosition(step){active+=step;if(active<0){active=listItems.size()-1;}else if(active>=listItems.size()){active=0;}}
function limitNumberOfItems(available){return options.max&&options.max<available?options.max:available;}
function fillList(){list.empty();var max=limitNumberOfItems(data.length);for(var i=0;i<max;i++){if(!data[i])
continue;var formatted=options.formatItem(data[i].data,i+1,max,data[i].value,term);if(formatted===false)
continue;var li=$("<li/>").html(options.highlight(formatted,term)).addClass(i%2==0?"ac_even":"ac_odd").appendTo(list)[0];$.data(li,"ac_data",data[i]);}
listItems=list.find("li");if(options.selectFirst){listItems.slice(0,1).addClass(CLASSES.ACTIVE);active=0;}
if($.fn.bgiframe)
list.bgiframe();}
return{display:function(d,q){init();data=d;term=q;fillList();},next:function(){moveSelect(1);},prev:function(){moveSelect(-1);},pageUp:function(){if(active!=0&&active-8<0){moveSelect(-active);}else{moveSelect(-8);}},pageDown:function(){if(active!=listItems.size()-1&&active+8>listItems.size()){moveSelect(listItems.size()-1-active);}else{moveSelect(8);}},hide:function(){element&&element.hide();listItems&&listItems.removeClass(CLASSES.ACTIVE);active=-1;},visible:function(){return element&&element.is(":visible");},current:function(){return this.visible()&&(listItems.filter("."+CLASSES.ACTIVE)[0]||options.selectFirst&&listItems[0]);},show:function(){var offset=$(input).offset();element.css({width:typeof options.width=="string"||options.width>0?options.width:$(input).width(),top:offset.top+input.offsetHeight,left:offset.left}).show();if(options.scroll){list.scrollTop(0);list.css({maxHeight:options.scrollHeight,overflow:'auto'});if($.browser.msie&&typeof document.body.style.maxHeight==="undefined"){var listHeight=0;listItems.each(function(){listHeight+=this.offsetHeight;});var scrollbarsVisible=listHeight>options.scrollHeight;list.css('height',scrollbarsVisible?options.scrollHeight:listHeight);if(!scrollbarsVisible){listItems.width(list.width()-parseInt(listItems.css("padding-left"))-parseInt(listItems.css("padding-right")));}}}},selected:function(){var selected=listItems&&listItems.filter("."+CLASSES.ACTIVE).removeClass(CLASSES.ACTIVE);return selected&&selected.length&&$.data(selected[0],"ac_data");},emptyList:function(){list&&list.empty();},unbind:function(){element&&element.remove();}};};$.fn.selection=function(start,end){if(start!==undefined){return this.each(function(){if(this.createTextRange){var selRange=this.createTextRange();if(end===undefined||start==end){selRange.move("character",start);selRange.select();}else{selRange.collapse(true);selRange.moveStart("character",start);selRange.moveEnd("character",end);selRange.select();}}else if(this.setSelectionRange){this.setSelectionRange(start,end);}else if(this.selectionStart){this.selectionStart=start;this.selectionEnd=end;}});}
var field=this[0];if(field.createTextRange){var range=document.selection.createRange(),orig=field.value,teststring="<->",textLength=range.text.length;range.text=teststring;var caretAt=field.value.indexOf(teststring);field.value=orig;this.selection(caretAt,caretAt+textLength);return{start:caretAt,end:caretAt+textLength}}else if(field.selectionStart!==undefined){return{start:field.selectionStart,end:field.selectionEnd}}};})(jQuery);var myLib=myLib===undefined?{}:lib;(function(){var cache={};myLib.render=function tmpl(str,data){var fn=!/\W/.test(str)?cache[str]=cache[str]||tmpl(document.getElementById(str).innerHTML):new Function("obj","var p=[],print=function(){p.push.apply(p,arguments);};"+"with(obj){p.push('"+
str.replace(/<!--/g,"").replace(/-->/g,"").replace(/[\r\t\n]/g," ").split("<%").join("\t").replace(/((^|%>)[^\t]*)'/g,"$1\r").replace(/\t=(.*?)%>/g,"',$1,'").split("\t").join("');").split("%>").join("p.push('").split("\r").join("\\'")
+"');}return p.join('');");return data?fn(data):fn;};})();myLib.str_repeat=function str_repeat(i,m){for(var o=[];m>0;o[--m]=i);return(o.join(''));};myLib.sprintf=function sprintf(){var i=0,a,f=arguments[i++],o=[],m,p,c,x;while(f){if(m=/^[^\x25]+/.exec(f))o.push(m[0]);else if(m=/^\x25{2}/.exec(f))o.push('%');else if(m=/^\x25(?:(\d+)\$)?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-fosuxX])/.exec(f)){if(((a=arguments[m[1]||i++])==null)||(a==undefined))throw("Too few arguments.");if(/[^s]/.test(m[7])&&(typeof(a)!='number'))
throw("Expecting number but found "+typeof(a));switch(m[7]){case'b':a=a.toString(2);break;case'c':a=String.fromCharCode(a);break;case'd':a=parseInt(a);break;case'e':a=m[6]?a.toExponential(m[6]):a.toExponential();break;case'f':a=m[6]?parseFloat(a).toFixed(m[6]):parseFloat(a);break;case'o':a=a.toString(8);break;case's':a=((a=String(a))&&m[6]?a.substring(0,m[6]):a);break;case'u':a=Math.abs(a);break;case'x':a=a.toString(16);break;case'X':a=a.toString(16).toUpperCase();break;}
a=(/[def]/.test(m[7])&&m[2]&&a>0?'+'+a:a);c=m[3]?m[3]=='0'?'0':m[3].charAt(1):' ';x=m[5]-String(a).length;p=m[5]?myLib.str_repeat(c,x):'';o.push(m[4]?a+p:p+a);}
else throw("Huh ?!");f=f.substring(m[0].length);}
return o.join('');};myLib.escape=function(val){return val.split("&").join("&amp;").split("<").join("&lt;").split(">").join("&gt;");};myLib.openWindowWithPost=function(url,name,options,data){var newWindow=window.open(url,name,options);if(!newWindow)return false;var html="";html+="<html><head></head><body><form id='formid' method='post' action='"+url+"'>";for(var i in data)
html+="<input type='hidden' name='"+i+"' value='"+myLib.escape(data[i])+"'/>";html+="</form><script type='text/javascript'>document.getElementById(\"formid\").submit()</script></body></html>";newWindow.document.write(html);return newWindow;};if(settings.addIngredientsLogic){$(function(){var maxIngredients=20;var mainUl=$('form.recipe ul.ingredients');var arTemplate='add_remove_tpl';var fixFinder={'id':'f_ingr__\\d+__(\\w+)','for':'f_ingr__\\d+__(\\w+)','name':'ingr\\.\\d+\\.(\\w+)'};var fixReplacer={'id':'f_ingr__%s__%s','for':'f_ingr__%s__%s','name':'ingr.%s.%s'};var addRowHtml;var _fixHelper=function(field,attr,i){var curAttrMatch=new RegExp(fixFinder[attr]).exec(field.attr(attr));field.attr(attr,myLib.sprintf(fixReplacer[attr],i,curAttrMatch[1]));};var fixIdsAndNames=function(){mainUl.find('li').each(function(i){$(this).find('label[for^=f_ingr__]').each(function(){_fixHelper($(this),'for',i)});$(this).find('input[id^=f_ingr__]').each(function(){_fixHelper($(this),'id',i)});$(this).find('input[name^=ingr]').each(function(){_fixHelper($(this),'name',i)});$(this).find('select[id^=f_ingr__]').each(function(){_fixHelper($(this),'id',i)});$(this).find('select[name^=ingr]').each(function(){_fixHelper($(this),'name',i)});});};var addHandler=function(){var newRow=addRowHtml.clone();$("input[id$=__portion]",newRow).numeric({allow:",."});addRecipeAutocompleteTo($("input[id$=__product]",newRow));$(this).parent().parent().parent().parent().append(newRow);fixIdsAndNames();redoButtons();};var removeHandler=function(){$(this).parent().parent().parent().remove();fixIdsAndNames();redoButtons();};var upHandler=function(){var prev=$(this).parent().parent().parent().prev(),curr=$(this).parent().parent().parent();var tmp=[$('input[id$=__product]',prev).val(),$('input[id$=__portion]',prev).val(),$('select[id$=__weight]',prev).val()];$('input[id$=__product]',prev).val($('input[id$=__product]',curr).val());$('input[id$=__portion]',prev).val($('input[id$=__portion]',curr).val());$('select[id$=__weight]',prev).val($('select[id$=__weight]',curr).val());$('input[id$=__product]',curr).val(tmp[0]);$('input[id$=__portion]',curr).val(tmp[1]);$('select[id$=__weight]',curr).val(tmp[2]);};var downHandler=function(){var next=$(this).parent().parent().parent().next(),curr=$(this).parent().parent().parent();var tmp=[$('input[id$=__product]',next).val(),$('input[id$=__portion]',next).val(),$('select[id$=__weight]',next).val()];$('input[id$=__product]',next).val($('input[id$=__product]',curr).val());$('input[id$=__portion]',next).val($('input[id$=__portion]',curr).val());$('select[id$=__weight]',next).val($('select[id$=__weight]',curr).val());$('input[id$=__product]',curr).val(tmp[0]);$('input[id$=__portion]',curr).val(tmp[1]);$('select[id$=__weight]',curr).val(tmp[2]);};var redoButtons=function(){var innerDl=mainUl.find('li dl');innerDl.find('.ingr_add_remove').remove();var dlCount=innerDl.length;innerDl.each(function(){var ar={'add':true,'remove':true,'up':true,'down':true};var $this=$(this);if($this.parent().prev().length==0&&dlCount==1){ar.remove=false;}
if(($this.parent().next().length==0&&dlCount==maxIngredients)||$this.parent().next().length){ar.add=false;}
if($this.parent().prev().length==0){ar.up=false;}
if($this.parent().next().length==0){ar.down=false;}
var html=$(myLib.render(arTemplate,ar));html.find('a.add').click(addHandler);html.find('a.delete').click(removeHandler);html.find('a.arrow-up').click(upHandler);html.find('a.arrow-down').click(downHandler);$(this).append(html);});};var addRecipeAutocompleteTo=function(elems){elems.autocomplete('/przepisy/autocomplete/product',{minChars:2,matchContains:"word",max:50,delay:600});};addRowHtml=mainUl.find('li:last').clone();addRowHtml.find('input').val('').end().find('select').val('g');mainUl.find('li:gt(0):last').remove();$("form.recipe #f_ig").numeric();$("form.recipe .ingredients input[id$=__portion]").numeric({allow:"."});redoButtons();$('<a class="preview_btn icon preview clearfix" title="Podgląd"></a>').click(function(){myLib.openWindowWithPost('/przepisy/podglad','preview','width=770,height=500,menubar=no,location=no,resizable=yes,scrollbars=yes,status=yes',{recipe:$('#f_recipe').val()});}).insertAfter('#f_recipe');addRecipeAutocompleteTo($("input[id$=__product]",mainUl));$('#f_tags').autocomplete('/przepisy/autocomplete/tag',{multiple:true,minChars:2,autoFill:true,max:50,delay:600});});};if(settings.recipeFavsKey){$(function(){$('#add_to_favs_btn').click(function(){var $this=$(this);if($this.hasClass('star_inactive')){$.post('/przepisy/ulubione/dodaj/'+settings.recipeFavsKey,{},function(){$this.addClass('star_active').removeClass('star_inactive');});}else{$.post('/przepisy/ulubione/usun/'+settings.recipeFavsKey,{},function(){$this.addClass('star_inactive').removeClass('star_active');});}});});};if(settings.removeDisableButtons){$(function(){$('a.remove_alert').live('click',function(){if(confirm('Czy naprawdę chcesz usunąć przepis?\n\nPamiętaj, że operacja jest nieodwracalna!')){$.post($(this).attr('href'),{},function(data,textStatus){window.location=data.redirectUrl;},'json');}
return false;});$('a.disable_alert').live('click',function(){if(confirm('Czy naprawdę chcesz wyłączyć przepis?')){$.post($(this).attr('href'),{},function(data,textStatus){window.location=data.redirectUrl;},'json');}
return false;});$('a.enable_alert').live('click',function(){if(confirm('Czy naprawdę chcesz włączyć przepis?')){$.post($(this).attr('href'),{},function(data,textStatus){window.location=data.redirectUrl;},'json');}
return false;});});};$(function(){var active=false;$('td.paging_next.use_xhr a, td.paging_prev.use_xhr a a').live('click',function(){if(active){return false;}
active=true;var $this_table=$(this).parents('table.xhr_targer'),url=$(this).attr('href');$this_table.addClass('loading').fadeTo('fast',0.5,function(){$this_table.load(url+' table>*',function(responseText,textStatus,XMLHttpRequest){$this_table.removeClass('loading').fadeTo('fast',1,function(){$(this).removeAttr('style')});active=false;});});return false;});});$(function(){if($('ul.flash').length==0){$('#no_js_info').after('<ul class="flash"></ul>');}
$('ul.flash').append('<li id="ajax_error_flash" class="error" style="display: none;">Błąd komunikacji z serwerem! Spróbuj ponownie później lub sprawdź połączenie z internetem.</li>');$('#ajax_error_flash').ajaxError(function(event,request,settings){$(this).show();});$('ul.flash li').each(function(){$('<div class="close" title="Ukryj">x</div>').click(function(){$(this).parent().fadeOut('fast')}).appendTo($(this));});var sqInput=$('#main_search input:first');var defaultText='Wpisz frazę...';$('#main_search').submit(function(){if(sqInput.val().length<3||sqInput.val()==defaultText){alert('Wyszukiwanie wymaga podania przynajmniej 3 znaków!');return false;}});$('#search_box').submit(function(){if($('input[name=q]',this).val().length<3){alert('Wyszukiwanie wymaga podania przynajmniej 3 znaków!');return false;}else{}});if(sqInput.val().length==0){sqInput.val(defaultText);}
sqInput.focus(function(){if(sqInput.val()==defaultText){sqInput.val('');}}).blur(function(){if(sqInput.val()==''){sqInput.val(defaultText);}});$('#adv_switch').click(function(){var advHidden=$('#search_box input[name=a]');if(advHidden.val()=='0'){$('.adv_search_opt').show('fast');advHidden.val('1');}else{$('.adv_search_opt').hide('fast');advHidden.val('0');}});});google.friendconnect.container.setParentUrl('/');var gfcSkins={};gfcSkins.signIn={BORDER_COLOR:'transparent',ENDCAP_BG_COLOR:'#2B6488',ENDCAP_TEXT_COLOR:'#fff',ENDCAP_LINK_COLOR:'#ddd',ALTERNATE_BG_COLOR:'#dddddd',CONTENT_BG_COLOR:'transparent',CONTENT_LINK_COLOR:'#ddd',CONTENT_TEXT_COLOR:'#fff',CONTENT_SECONDARY_LINK_COLOR:'#3C91C7',CONTENT_SECONDARY_TEXT_COLOR:'#ddd',CONTENT_HEADLINE_COLOR:'#fff',ALIGNMENT:'right'};gfcSkins.members={BORDER_COLOR:'transparent',ENDCAP_BG_COLOR:'transparent',ENDCAP_TEXT_COLOR:'#333333',ENDCAP_LINK_COLOR:'#2B6488',ALTERNATE_BG_COLOR:'#dddddd',CONTENT_BG_COLOR:'transparent',CONTENT_LINK_COLOR:'#2B6488',CONTENT_TEXT_COLOR:'#333333',CONTENT_SECONDARY_LINK_COLOR:'#3C91C7',CONTENT_SECONDARY_TEXT_COLOR:'#555555',CONTENT_HEADLINE_COLOR:'#333333',NUMBER_ROWS:'3'};gfcSkins.review={BORDER_COLOR:'transparent',ENDCAP_BG_COLOR:'transparent',ENDCAP_TEXT_COLOR:'#333333',ENDCAP_LINK_COLOR:'#2B6488',ALTERNATE_BG_COLOR:'#dddddd',CONTENT_BG_COLOR:'transparent',CONTENT_LINK_COLOR:'#2B6488',CONTENT_TEXT_COLOR:'#333333',CONTENT_SECONDARY_LINK_COLOR:'#3C91C7',CONTENT_SECONDARY_TEXT_COLOR:'#555555',CONTENT_HEADLINE_COLOR:'#333333',DEFAULT_COMMENT_TEXT:'\u2013 dodaj tutaj swoj\u0105 recenzj\u0119 \u2013',HEADER_TEXT:'Oceny',POSTS_PER_PAGE:'5'};gfcSkins.recommend_btn={HEIGHT:'21',BUTTON_STYLE:'compact',BUTTON_TEXT:'Pole\u0107 innym!',BUTTON_ICON:'default'};gfcSkins.recommend={BORDER_COLOR:'transparent',ENDCAP_BG_COLOR:'transparent',ENDCAP_TEXT_COLOR:'#333333',ENDCAP_LINK_COLOR:'#2B6488',ALTERNATE_BG_COLOR:'#dddddd',CONTENT_BG_COLOR:'transparent',CONTENT_LINK_COLOR:'#2B6488',CONTENT_TEXT_COLOR:'#333333',CONTENT_SECONDARY_LINK_COLOR:'#3C91C7',CONTENT_SECONDARY_TEXT_COLOR:'#555555',CONTENT_HEADLINE_COLOR:'#333333',HEADER_TEXT:'Zobacz, co polecają inni...',RECOMMENDATIONS_PER_PAGE:'10'};gfcSkins.activity={BORDER_COLOR:'transparent',ENDCAP_BG_COLOR:'transparent',ENDCAP_TEXT_COLOR:'#333333',ENDCAP_LINK_COLOR:'#2B6488',ALTERNATE_BG_COLOR:'#dddddd',CONTENT_BG_COLOR:'transparent',CONTENT_LINK_COLOR:'#2B6488',CONTENT_TEXT_COLOR:'#333333',CONTENT_SECONDARY_LINK_COLOR:'#3C91C7',CONTENT_SECONDARY_TEXT_COLOR:'#555555',CONTENT_HEADLINE_COLOR:'#333333',HEIGHT:'240'};google.friendconnect.container.initOpenSocialApi({site:settings.gfcSiteId,onload:settings.gfcOnLoad||function(securityToken){if(!window.gfcFirstTime){window.gfcFirstTime=1;}else{window.top.location.reload();}}});$(function(){if($('#gfc_login').length){google.friendconnect.container.renderSignInGadget({id:'gfc_login',site:settings.gfcSiteId},gfcSkins.signIn);}
if($('#gfc_button').length){google.friendconnect.renderSignInButton({'id':'gfc_button','style':'long','text':'Zaloguj się używając Sieci Znajomych Google'});}
if($('#gfc_members').length){google.friendconnect.container.renderMembersGadget({id:'gfc_members',site:settings.gfcSiteId},gfcSkins.members);}
if($('#gfc_review').length){google.friendconnect.container.renderReviewGadget({id:'gfc_review',site:settings.gfcSiteId,'view-params':{"disableMinMax":"true","scope":"PAGE","startMaximized":"true"}},gfcSkins.review);}
if($('#gfc_recommend_btn').length){google.friendconnect.container.renderOpenSocialGadget({id:'gfc_recommend_btn',url:'http://www.google.com/friendconnect/gadgets/recommended_pages.xml',height:21,site:settings.gfcSiteId,'view-params':{"pageUrl":location.href,"pageTitle":(document.title?document.title.replace(' - Przepisy diety Montignac',''):location.href),"docId":"recommendedPages"}},gfcSkins.recommend_btn);}
if($('#gfc_recommend').length){google.friendconnect.container.renderOpenSocialGadget({id:'gfc_recommend',url:'http://www.google.com/friendconnect/gadgets/recommended_pages.xml',site:settings.gfcSiteId,'view-params':{"docId":"recommendedPages"}},gfcSkins.recommend);}
if($('#gfc_activity').length){google.friendconnect.container.renderOpenSocialGadget({id:'gfc_activity',url:'http://www.google.com/friendconnect/gadgets/activities.xml',height:240,site:settings.gfcSiteId,'view-params':{"scope":"SITE"}},gfcSkins.activity);}});